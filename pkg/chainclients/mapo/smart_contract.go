package mapo

import (
	"fmt"
	"github.com/ethereum/go-ethereum/accounts/abi"
	"strings"
)

const (
	maintainerAbi = `[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address","name":"authority","type":"address"}],"name":"AccessManagedInvalidAuthority","type":"error"},{"inputs":[{"internalType":"address","name":"caller","type":"address"},{"internalType":"uint32","name":"delay","type":"uint32"}],"name":"AccessManagedRequiredDelay","type":"error"},{"inputs":[{"internalType":"address","name":"caller","type":"address"}],"name":"AccessManagedUnauthorized","type":"error"},{"inputs":[{"internalType":"address","name":"target","type":"address"}],"name":"AddressEmptyCode","type":"error"},{"inputs":[],"name":"ECDSAInvalidSignature","type":"error"},{"inputs":[{"internalType":"uint256","name":"length","type":"uint256"}],"name":"ECDSAInvalidSignatureLength","type":"error"},{"inputs":[{"internalType":"bytes32","name":"s","type":"bytes32"}],"name":"ECDSAInvalidSignatureS","type":"error"},{"inputs":[{"internalType":"address","name":"implementation","type":"address"}],"name":"ERC1967InvalidImplementation","type":"error"},{"inputs":[],"name":"ERC1967NonPayable","type":"error"},{"inputs":[],"name":"EnforcedPause","type":"error"},{"inputs":[],"name":"ExpectedPause","type":"error"},{"inputs":[],"name":"FailedCall","type":"error"},{"inputs":[],"name":"InvalidInitialization","type":"error"},{"inputs":[],"name":"NotInitializing","type":"error"},{"inputs":[],"name":"ReentrancyGuardReentrantCall","type":"error"},{"inputs":[],"name":"UUPSUnauthorizedCallContext","type":"error"},{"inputs":[{"internalType":"bytes32","name":"slot","type":"bytes32"}],"name":"UUPSUnsupportedProxiableUUID","type":"error"},{"inputs":[],"name":"already_distributed","type":"error"},{"inputs":[],"name":"already_proposed","type":"error"},{"inputs":[],"name":"already_registerd","type":"error"},{"inputs":[],"name":"blame_not_in_maitainer","type":"error"},{"inputs":[],"name":"blame_repeat","type":"error"},{"inputs":[],"name":"blame_zero_address","type":"error"},{"inputs":[],"name":"empty_p2pAddress","type":"error"},{"inputs":[],"name":"empty_pubkey","type":"error"},{"inputs":[],"name":"in_black_list","type":"error"},{"inputs":[],"name":"invalid_de_register_status","type":"error"},{"inputs":[],"name":"invalid_epoch","type":"error"},{"inputs":[],"name":"invalid_member_and_blame","type":"error"},{"inputs":[],"name":"invalid_public_key_length","type":"error"},{"inputs":[],"name":"invalid_signature","type":"error"},{"inputs":[],"name":"invalid_tss_pool_id","type":"error"},{"inputs":[],"name":"maintainer_not_enough","type":"error"},{"inputs":[],"name":"member_not_in_maitainer","type":"error"},{"inputs":[],"name":"member_repeat","type":"error"},{"inputs":[],"name":"member_zero_address","type":"error"},{"inputs":[],"name":"native_transer_failed","type":"error"},{"inputs":[],"name":"not_registered","type":"error"},{"inputs":[],"name":"only_maitainer","type":"error"},{"inputs":[],"name":"only_relay","type":"error"},{"inputs":[],"name":"only_validator_can_register","type":"error"},{"inputs":[],"name":"only_vm_can_call","type":"error"},{"inputs":[],"name":"vault_not_found","type":"error"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address[]","name":"blames","type":"address[]"}],"name":"AddToBlacklist","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"authority","type":"address"}],"name":"AuthorityUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"user","type":"address"}],"name":"DeRegister","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"epoch","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"reward","type":"uint256"}],"name":"DistributeEpochRewards","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"epoch","type":"uint256"},{"indexed":false,"internalType":"address[]","name":"_maitainers","type":"address[]"}],"name":"Election","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint64","name":"version","type":"uint64"}],"name":"Initialized","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"bytes32","name":"txHash","type":"bytes32"}],"name":"MigrationComplete","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"chain","type":"uint256"},{"indexed":false,"internalType":"bytes","name":"retiring","type":"bytes"}],"name":"MigrationGasNotEnough","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"epoch","type":"uint256"}],"name":"NewEpoch","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"epoch","type":"uint256"},{"indexed":false,"internalType":"bytes32","name":"id","type":"bytes32"},{"indexed":false,"internalType":"bytes","name":"pubkey","type":"bytes"},{"indexed":false,"internalType":"address[]","name":"members","type":"address[]"}],"name":"NewVault","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"account","type":"address"}],"name":"Paused","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"bytes","name":"secp256Pubkey","type":"bytes"},{"indexed":false,"internalType":"bytes","name":"ed25519PubKey","type":"bytes"},{"indexed":false,"internalType":"string","name":"p2pAddress","type":"string"},{"indexed":false,"internalType":"uint248","name":"version","type":"uint248"}],"name":"Register","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"_relay","type":"address"},{"indexed":false,"internalType":"address","name":"_gasService","type":"address"},{"indexed":false,"internalType":"address","name":"_tokenRegister","type":"address"}],"name":"Set","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"_limit","type":"uint256"}],"name":"SetMaitanerLimit","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"bytes32","name":"orderId","type":"bytes32"}],"name":"TxOutComplete","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"account","type":"address"}],"name":"Unpaused","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"bytes","name":"secp256Pubkey","type":"bytes"},{"indexed":false,"internalType":"bytes","name":"ed25519PubKey","type":"bytes"},{"indexed":false,"internalType":"string","name":"p2pAddress","type":"string"}],"name":"Update","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"bool","name":"flag","type":"bool"}],"name":"UpdateBlacklist","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"implementation","type":"address"}],"name":"Upgraded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"epoch","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"chain","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"height","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"limit","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"price","type":"uint256"}],"name":"VoteNetworkFee","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"account","type":"address"},{"indexed":false,"internalType":"uint256","name":"epoch","type":"uint256"},{"components":[{"internalType":"enum TxInType","name":"txInType","type":"uint8"},{"internalType":"uint128","name":"toChain","type":"uint128"},{"internalType":"uint128","name":"height","type":"uint128"},{"internalType":"uint128","name":"fromChain","type":"uint128"},{"internalType":"uint128","name":"amount","type":"uint128"},{"internalType":"bytes32","name":"orderId","type":"bytes32"},{"internalType":"bytes","name":"vault","type":"bytes"},{"internalType":"bytes","name":"token","type":"bytes"},{"internalType":"bytes","name":"from","type":"bytes"},{"internalType":"bytes","name":"to","type":"bytes"},{"internalType":"bytes","name":"payload","type":"bytes"}],"indexed":false,"internalType":"struct TxInItem","name":"txInItem","type":"tuple"}],"name":"VoteTxIn","type":"event"},{"anonymous":false,"inputs":[{"components":[{"internalType":"bytes32","name":"id","type":"bytes32"},{"internalType":"uint256","name":"epoch","type":"uint256"},{"internalType":"bytes","name":"pubkey","type":"bytes"},{"internalType":"address[]","name":"members","type":"address[]"},{"internalType":"address[]","name":"blames","type":"address[]"},{"internalType":"bytes","name":"signature","type":"bytes"}],"indexed":false,"internalType":"struct Maitainer1.TssPoolParam","name":"param","type":"tuple"}],"name":"VoteUpdateTssPool","type":"event"},{"inputs":[],"name":"ACCOUNTS_ADDRESS","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ELECTIONS_ADDRESS","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"UPGRADE_INTERFACE_VERSION","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"VALIDATORS_ADDRESS","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes","name":"publicKey","type":"bytes"}],"name":"_publicKeyToAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"bytes","name":"secp256Pubkey","type":"bytes"},{"internalType":"bytes","name":"ed25519PubKey","type":"bytes"},{"internalType":"string","name":"p2pAddress","type":"string"}],"name":"adminRegister","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"authority","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bool","name":"withCall","type":"bool"},{"internalType":"uint256","name":"chain","type":"uint256"},{"internalType":"bytes","name":"token","type":"bytes"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"chooseVault","outputs":[{"internalType":"bytes","name":"vault","type":"bytes"},{"internalType":"uint256","name":"transactionRate","type":"uint256"},{"internalType":"uint256","name":"transationSize","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"currentEpoch","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"deRegister","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"epoch","type":"uint256"}],"name":"distributeEpochRewards","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"election","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"gasService","outputs":[{"internalType":"contract IGasService","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getElectionEpoch","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"epoch","type":"uint256"}],"name":"getEpochInfo","outputs":[{"internalType":"enum Maitainer1.EpochStatus","name":"status","type":"uint8"},{"internalType":"address[]","name":"maitainers","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint128","name":"blockNumber","type":"uint128"}],"name":"getEpochInfoByBlockNumber","outputs":[{"internalType":"enum Maitainer1.EpochStatus","name":"status","type":"uint8"},{"internalType":"address[]","name":"maitainers","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bool","name":"withCall","type":"bool"},{"internalType":"uint256","name":"chain","type":"uint256"}],"name":"getGas","outputs":[{"internalType":"uint256","name":"transactionRate","type":"uint256"},{"internalType":"uint256","name":"transationSize","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getImplementation","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getLastPublickey","outputs":[{"internalType":"bytes","name":"","type":"bytes"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"chain","type":"uint256"}],"name":"getLastTxInHeight","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"chain","type":"uint256"}],"name":"getLastTxOutHeight","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"m","type":"address"}],"name":"getMaitainer","outputs":[{"components":[{"internalType":"enum Maitainer1.MaintainerStatus","name":"status","type":"uint8"},{"internalType":"uint88","name":"version","type":"uint88"},{"internalType":"address","name":"addr","type":"address"},{"internalType":"bytes","name":"secp256Pubkey","type":"bytes"},{"internalType":"bytes","name":"ed25519Pubkey","type":"bytes"},{"internalType":"string","name":"p2pAddress","type":"string"}],"internalType":"struct Maitainer1.MaitainerInfo","name":"info","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"epoch","type":"uint256"}],"name":"getMaitainerEpochScore","outputs":[{"internalType":"address[]","name":"maitainers","type":"address[]"},{"internalType":"int256[]","name":"scores","type":"int256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"epoch","type":"uint256"}],"name":"getMaitainers","outputs":[{"components":[{"internalType":"enum Maitainer1.MaintainerStatus","name":"status","type":"uint8"},{"internalType":"uint88","name":"version","type":"uint88"},{"internalType":"address","name":"addr","type":"address"},{"internalType":"bytes","name":"secp256Pubkey","type":"bytes"},{"internalType":"bytes","name":"ed25519Pubkey","type":"bytes"},{"internalType":"string","name":"p2pAddress","type":"string"}],"internalType":"struct Maitainer1.MaitainerInfo[]","name":"minfo","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"chain","type":"uint256"},{"internalType":"uint256","name":"tokens","type":"uint256"}],"name":"getMigrationGas","outputs":[{"internalType":"uint256","name":"gas","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"chain","type":"uint256"}],"name":"getNative","outputs":[{"internalType":"bytes","name":"native","type":"bytes"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getPublickeys","outputs":[{"internalType":"bytes[]","name":"keys","type":"bytes[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes","name":"publicKey","type":"bytes"}],"name":"getVaultInfo","outputs":[{"internalType":"enum IMaitainer.VaultStatus","name":"status","type":"uint8"},{"internalType":"address[]","name":"members","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes","name":"publicKey","type":"bytes"},{"internalType":"uint256","name":"chain","type":"uint256"},{"internalType":"bytes","name":"token","type":"bytes"}],"name":"getVaultTokenAllowances","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_defaultAdmin","type":"address"}],"name":"initialize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"isConsumingScheduledOp","outputs":[{"internalType":"bytes4","name":"","type":"bytes4"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"maitainerLimit","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"migration","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"migrationProposes","outputs":[{"internalType":"bool","name":"status","type":"bool"},{"internalType":"uint248","name":"count","type":"uint248"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"networkFeeProposes","outputs":[{"internalType":"bool","name":"status","type":"bool"},{"internalType":"uint248","name":"count","type":"uint248"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"paused","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"proxiableUUID","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes","name":"secp256Pubkey","type":"bytes"},{"internalType":"bytes","name":"ed25519PubKey","type":"bytes"},{"internalType":"string","name":"p2pAddress","type":"string"}],"name":"register","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"relay","outputs":[{"internalType":"contract IRelay","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_relay","type":"address"},{"internalType":"address","name":"_gasService","type":"address"},{"internalType":"address","name":"_tokenRegister","type":"address"}],"name":"set","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newAuthority","type":"address"}],"name":"setAuthority","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_limit","type":"uint256"}],"name":"setMaitanerLimit","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"tokenRegister","outputs":[{"internalType":"contract ITokenRegister","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"trigger","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"txInProposes","outputs":[{"internalType":"bool","name":"status","type":"bool"},{"internalType":"uint248","name":"count","type":"uint248"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"txOutProposes","outputs":[{"internalType":"bool","name":"status","type":"bool"},{"internalType":"uint248","name":"count","type":"uint248"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes","name":"secp256Pubkey","type":"bytes"},{"internalType":"bytes","name":"ed25519PubKey","type":"bytes"},{"internalType":"string","name":"p2pAddress","type":"string"}],"name":"update","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"bool","name":"flag","type":"bool"}],"name":"updateBlacklist","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"updateTSSPoolProposes","outputs":[{"internalType":"bool","name":"status","type":"bool"},{"internalType":"uint248","name":"count","type":"uint248"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newImplementation","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"upgradeToAndCall","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"version","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"epoch","type":"uint256"},{"internalType":"uint256","name":"chain","type":"uint256"},{"internalType":"uint256","name":"height","type":"uint256"},{"internalType":"uint256","name":"transactionSize","type":"uint256"},{"internalType":"uint256","name":"transactionSizeWithCall","type":"uint256"},{"internalType":"uint256","name":"transactionRate","type":"uint256"}],"name":"voteNetworkFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"bytes32","name":"id","type":"bytes32"},{"internalType":"uint256","name":"epoch","type":"uint256"},{"internalType":"bytes","name":"pubkey","type":"bytes"},{"internalType":"address[]","name":"members","type":"address[]"},{"internalType":"address[]","name":"blames","type":"address[]"},{"internalType":"bytes","name":"signature","type":"bytes"}],"internalType":"struct Maitainer1.TssPoolParam","name":"param","type":"tuple"}],"name":"voteUpdateTssPool","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}]`
	idPackAbi     = `[{"inputs":[{"internalType":"bytes","name":"pubkey","type":"bytes"},{"internalType":"address[]","name":"members","type":"address[]"},{"internalType":"uint256","name":"epoch","type":"uint256"},{"internalType":"address[]","name":"blames","type":"address[]"}],"name":"idPack","outputs":[],"stateMutability":"nonpayable","type":"function"}]`
)

func newMaintainerABi() (*abi.ABI, error) {
	maintainer, err := abi.JSON(strings.NewReader(maintainerAbi))
	if err != nil {
		return nil, fmt.Errorf("fail to unmarshal maintainer abi: %w", err)
	}

	return &maintainer, nil
}

func newIdABi() (*abi.ABI, error) {
	maintainer, err := abi.JSON(strings.NewReader(idPackAbi))
	if err != nil {
		return nil, fmt.Errorf("fail to unmarshal maintainer abi: %w", err)
	}

	return &maintainer, nil
}
