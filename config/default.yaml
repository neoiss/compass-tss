########################################################################################
# Bifrost
########################################################################################
# trunk-ignore-all(codespell/misspelled)
bifrost:
  # leveldb defaults to start, plus 10 bit per key filter
  observer_leveldb: &default-leveldb
    filter_bits_per_key: 10
    compaction_table_size_multiplier: 1
    write_buffer: 4194304
    block_cache_capacity: 8388608
    compact_on_init: true
  observer_workers: 0

  metrics:
    enabled: true
    pprof_enabled: false
    listen_port: 9000
    read_timeout: 30s
    write_timeout: 30s
    chains:
      - BTC
      - BSC
      - ETH
      - BASE
      - ARB
  map_relay:
    chain_id: map
    chain_host: https://mrpc.chainservice.io
    signer_name: "first_cosmos_name"
    keystore_path: "./keystore/UTC--2025-07-30T07-55-30.878196000Z--25fa71d4f689f4b65eb6d020a414090828281d51"
    maintainer: "0x7e22B9FC15054546028Df928eB7560AEd8F0eF48"
    tss_manager: "0x062B3Bd0B1A0c9d3cE35dC59D8F5E929314a8706"
    relay: "0x42D64eD9381bF456697b0C360e8acE139F176a80"
    gas_service: "0x43A7dd204f6604F2578Bd5d0859f45296d27F23A"
    token_registry: "0x78D31173C04e5F1D4b0172440B09453C27990527"
    view_controller: "0xaf720ad7086627034c4d8CA2b4493079E97f1C3A"
    cross_data_path: "./build/cross_dbs"
    cross_data_address: "0.0.0.0:6041"
  signer:
    backup_keyshares: true
    signer_db_path: ./build/signer_db
    retry_interval: 2s
    reschedule_buffer_blocks: 150 # 15 minutes
    block_scanner:
      chain_id: map
      start_block_height: 0
      block_retry_interval: 10s
      block_height_discover_back_off: 5s
      block_scan_processors: 1
      http_request_timeout: 30s
      http_request_read_timeout: 30s
      http_request_write_timeout: 30s
      max_http_request_retry: "10"
      max_gas_limit: 1000000
      max_swap_gas_limit: 1500000
    leveldb: *default-leveldb
    keygen_timeout: 5m
    keysign_timeout: 45s
    party_timeout: 45s
    pre_param_timeout: 5m
  tss:
    rendezvous: asgard
    p2p_port: 5040
    info_address: 0.0.0.0:6040
    bootstrap_peers:
      - 172.26.113.106
      - 172.26.113.107
      - 172.26.113.108
    external_ip: ""
    max_keyshare_recover_scan_blocks: 100
  chains:
    btc: &default-chain
      disabled: false
      chain_id: BTC
      username:
      password:
      http_post_mode: 1
      disable_tls: 1
      parallel_mempool_scan: 5
      mempool_tx_id_cache_size: 1_000_000
      scanner_leveldb:
        <<: *default-leveldb
        compaction_table_size_multiplier: 10
        write_buffer: 20971520 # 20mb
        block_cache_capacity: 536870912 # 512mb
      min_confirmations: 0
      max_rpc_retries: 9 # about 1 min
      max_pending_nonces: 0
      authorization_bearer: ""
      max_gas_tip_percentage: 0
      token_max_gas_multiplier: 0
      aggregator_max_gas_multiplier: 0
      utxo: &utxo
        block_cache_count: 144
        transaction_batch_size: 500
        max_mempool_batches: 10
        estimated_average_tx_size: 1000
        estimated_average_tx_swap_size: 2000
        default_min_relay_fee_sats: 1000
        default_sats_per_vbyte: 25
        max_sats_per_vbyte: 9765 # backwards compatible with 1e8/10/1024
        min_sats_per_vbyte: 2
        min_utxo_confirmations: 1
        max_utxos_to_spend: 10
      block_scanner: &default-block-scanner
        max_reorg_rescan_blocks: 72 # 12h
        chain_id: BTC
        enforce_block_height: false
        block_scan_processors: 1
        block_height_discover_back_off: 5s
        observation_flexibility_blocks: 3
        block_retry_interval: 10s
        http_request_timeout: 30s
        http_request_read_timeout: 30s
        http_request_write_timeout: 30s
        max_http_request_retry: 10
        db_path: ./build/observer
        scan_mempool: true
        max_contract_tx_logs: 0
        # the following defaults must be defined to override with environment
        start_block_height: 263889
        cosmos_grpc_tls: false
        gas_cache_blocks: 0
        whitelist_tokens: []
        whitelist_cosmos_assets: []
        concurrency: 0
        max_gas_limit: 1000000
        max_swap_gas_limit: 1500000
        fixed_gas_rate: 0
        gas_price_resolution: 10_000_000_000 # 10 gwei
        max_resume_block_lag: 24h
        max_healthy_lag: 30m
        transaction_batch_size: 500

      # the following defaults must be defined to override with environment
      chain_host: ""
      chain_network: ""
      rpc_host: "https://rpc.bitlayer.org"
      cosmos_grpc_tls: false
      opt_to_retire: false
      solvency_blocks: 0

    eth:
      <<: *default-chain
      chain_id: ETH
      rpc_host: "https://cf-rpc.omniservice.dev/compass/sepolia"
      max_pending_nonces: 3
      max_gas_tip_percentage: 20
      limit_multiplier: 2
      max_gas_limit: 3000000
      token_max_gas_multiplier: 3
      aggregator_max_gas_multiplier: 10
      block_scanner:
        <<: *default-block-scanner
        mos: 0x42D64eD9381bF456697b0C360e8acE139F176a80
        max_reorg_rescan_blocks: 96 # 3 epochs
        gas_cache_blocks: 40
        concurrency: 1
        chain_id: ETH
        observation_flexibility_blocks: 20
        max_gas_limit: 100000
        max_swap_gas_limit: 150000
        max_contract_tx_logs: 50
        start_block_height: 9763169
        gas_price_resolution: 1000000
      mempool_tx_id_cache_size: 0
      scanner_leveldb: *default-leveldb

    base:
      <<: *default-chain
      chain_id: BASE
      rpc_host: "https://base.drpc.org"
      solvency_blocks: 100
      max_pending_nonces: 3
      max_gas_tip_percentage: 20
      limit_multiplier: 2
      max_gas_limit: 3000000
      token_max_gas_multiplier: 3
      aggregator_max_gas_multiplier: 10
      block_scanner:
        <<: *default-block-scanner
        mos: 0x42D64eD9381bF456697b0C360e8acE139F176a80
        gas_cache_blocks: 40
        gas_price_resolution: 1
        concurrency: 1
        chain_id: BASE
        observation_flexibility_blocks: 20
        max_gas_limit: 1000000
        max_swap_gas_limit: 1500000
        max_contract_tx_logs: 50
      mempool_tx_id_cache_size: 0
      scanner_leveldb: *default-leveldb

    bsc:
      disabled: false
      <<: *default-chain
      chain_id: BSC
      rpc_host: "https://bsc-testnet.drpc.org"
      solvency_blocks: 100
      max_pending_nonces: 3
      token_max_gas_multiplier: 3
      aggregator_max_gas_multiplier: 10
      limit_multiplier: 2
      max_gas_limit: 3000000
      block_scanner:
        <<: *default-block-scanner
        mos: 0x42D64eD9381bF456697b0C360e8acE139F176a80
        max_reorg_rescan_blocks: 600 # 30m
        concurrency: 1
        chain_id: BSC
        gas_cache_blocks: 40
        gas_price_resolution: 1 # 10 gwei
        observation_flexibility_blocks: 80
        max_gas_limit: 1000000
        max_swap_gas_limit: 1500000
        max_contract_tx_logs: 50
        start_block_height: 
      mempool_tx_id_cache_size: 0
      scanner_leveldb: *default-leveldb

    arb:
      disabled: false
      <<: *default-chain
      chain_id: ARB
      rpc_host: "https://arb-mainnet-public.unifra.io"
      solvency_blocks: 100
      max_pending_nonces: 3
      token_max_gas_multiplier: 3
      aggregator_max_gas_multiplier: 10
      limit_multiplier: 2
      max_gas_limit: 3000000
      block_scanner:
        <<: *default-block-scanner
        mos: 0x42D64eD9381bF456697b0C360e8acE139F176a80
        max_reorg_rescan_blocks: 600 # 30m
        concurrency: 1
        chain_id: ARB
        gas_cache_blocks: 40
        gas_price_resolution: 1000000 # 10 gwei
        observation_flexibility_blocks: 80
        max_gas_limit: 1000000
        max_swap_gas_limit: 1500000
        max_contract_tx_logs: 50
        start_block_height: 
        max_healthy_lag: 30s
      mempool_tx_id_cache_size: 0
      scanner_leveldb: *default-leveldb